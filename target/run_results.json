{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.2", "generated_at": "2025-08-12T01:54:45.905342Z", "invocation_id": "1708f1dc-9916-4487-8c12-abdde006f81c", "invocation_started_at": "2025-08-12T01:54:12.503324Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-12T01:54:23.110024Z", "completed_at": "2025-08-12T01:54:23.197342Z"}, {"name": "execute", "started_at": "2025-08-12T01:54:23.207344Z", "completed_at": "2025-08-12T01:54:27.149926Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 4.099727392196655, "adapter_response": {"_message": "OK", "query_id": "01f0771f-44df-19d2-abf6-ecf392b8d66b"}, "message": "OK", "failures": null, "unique_id": "model.dbt_checkpoint3_dw.stg_person_person_details", "compiled": true, "compiled_code": "with source as (\n    select * \n    from `ted_dev`.`bronze`.`raw_sqlserver_person_person_db`\n),\n\nrevised as (\n\n    select\n        BusinessEntityID as person_id\n        , PersonType as person_type\n        , cast(NameStyle as boolean) as name_style\n        , Title as title\n        , FirstName as first_name\n        , MiddleName as middle_name\n        , LastName as last_name\n        , Suffix as suffix\n        , EmailPromotion as email_promotion\n        , AdditionalContactInfo as additional_contact_info\n        , Demographics as demographics\n        , rowguid as row_guid\n        , cast(ModifiedDate as date) as modified_date\n    from source\n\n)\n\nselect * from revised", "relation_name": "`ted_dev`.`db_silver`.`stg_person_person_details`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-12T01:54:23.127516Z", "completed_at": "2025-08-12T01:54:23.150432Z"}, {"name": "execute", "started_at": "2025-08-12T01:54:23.167546Z", "completed_at": "2025-08-12T01:54:27.171514Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 4.114557981491089, "adapter_response": {"_message": "OK", "query_id": "01f0771f-4579-12c3-8353-a92604969368"}, "message": "OK", "failures": null, "unique_id": "model.dbt_checkpoint3_dw.stg_sales_currency_rate", "compiled": true, "compiled_code": "with source as (\n    select * \n    from `ted_dev`.`bronze`.`raw_sqlserver_sales_currencyrate_db`\n),\n\nrevised as (\n    select\n        CurrencyRateID as currency_rate_id\n        , cast(CurrencyRateDate as date) as currency_rate_date\n        , FromCurrencyCode as from_currency_code\n        , ToCurrencyCode as to_currency_code\n        , cast(AverageRate as decimal(18,2)) as average_rate\n        , cast(EndOfDayRate as decimal(18,2)) as end_of_day_rate\n        , cast(ModifiedDate as date) as modified_date\n    from source\n)\n\nselect * from revised", "relation_name": "`ted_dev`.`db_silver`.`stg_sales_currency_rate`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-12T01:54:23.117125Z", "completed_at": "2025-08-12T01:54:23.190564Z"}, {"name": "execute", "started_at": "2025-08-12T01:54:23.199008Z", "completed_at": "2025-08-12T01:54:27.173376Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 4.1191651821136475, "adapter_response": {"_message": "OK", "query_id": "01f0771f-457a-129f-8d6d-eefc8d4bcbb2"}, "message": "OK", "failures": null, "unique_id": "model.dbt_checkpoint3_dw.stg_production_product_details", "compiled": true, "compiled_code": "with source as (\n    select * \n    from `ted_dev`.`bronze`.`raw_sqlserver_production_product_db`\n),\n\nrevised as (\n\n    select\n        ProductID         as product_id\n        , Name              as product_name\n        , ProductNumber     as product_number\n        , MakeFlag         as is_make\n        , FinishedGoodsFlag as is_finished_goods\n        , Color             as product_color\n        , SafetyStockLevel  as safety_stock_level\n        , ReorderPoint      as reorder_point\n        , cast(StandardCost as decimal(18,2))      as standard_cost\n        , cast(ListPrice as decimal(18,2))         as list_price\n        , Size              as product_size\n        , SizeUnitMeasureCode as size_unit_measure_code\n        , WeightUnitMeasureCode as weight_unit_measure_code\n        , Weight            as product_weight\n        , DaysToManufacture as days_to_manufacture\n        , ProductLine       as product_line\n        , Class             as product_class\n        , Style             as product_style\n        , ProductSubcategoryID as product_subcategory_id\n        , ProductModelID    as product_model_id\n        , cast(SellStartDate as date)     as sell_start_date\n        , cast(SellEndDate as date)       as sell_end_date\n        , cast(DiscontinuedDate as date)  as discontinued_date\n        , rowguid           as row_guid\n        , cast(ModifiedDate as date)      as modified_date\n\n    from source\n\n)\n\nselect * from revised", "relation_name": "`ted_dev`.`db_silver`.`stg_production_product_details`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-12T01:54:27.211271Z", "completed_at": "2025-08-12T01:54:27.217205Z"}, {"name": "execute", "started_at": "2025-08-12T01:54:27.221285Z", "completed_at": "2025-08-12T01:54:28.763868Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.56978440284729, "adapter_response": {"_message": "OK", "query_id": "01f0771f-471b-132f-971d-7f816c85706b"}, "message": "OK", "failures": null, "unique_id": "model.dbt_checkpoint3_dw.stg_sales_order_header", "compiled": true, "compiled_code": "with source as (\n    select * \n    from `ted_dev`.`bronze`.`raw_sqlserver_sales_salesorderheader_db`\n),\n\nrenamed as (\n\n    select\n        SalesOrderID         as order_id\n        , RevisionNumber       as nm_revisao\n        , cast(OrderDate as date)           as order_date\n        , cast(DueDate as date)             as due_date\n        , cast(ShipDate as date)            as ship_date\n        , OnlineOrderFlag    as is_online_order\n        , SalesOrderNumber    as order_number\n        , PurchaseOrderNumber as purchase_order_number\n        , AccountNumber       as account_number\n        , CustomerID          as customer_id\n        , SalesPersonID       as sales_person_id\n        , TerritoryID         as territory_id\n        , BillToAddressID     as bill_to_address_id\n        , ShipToAddressID     as ship_to_address_id\n        , ShipMethodID        as ship_method_id\n        , CreditCardID        as credit_card_id\n        , CreditCardApprovalCode as credit_card_approval_code\n        , CurrencyRateID      as currency_rate_id\n        , cast(SubTotal as decimal(18,2))            as sub_total\n        , cast(TaxAmt as decimal(18,2))              as tax_amount\n        , cast(Freight as decimal(18,2))             as freight\n        , cast(TotalDue as decimal(18,2))            as total_due\n        , Comment             as comment\n        , rowguid            as row_guid\n        , cast(ModifiedDate as date)        as modified_date\n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "`ted_dev`.`db_silver`.`stg_sales_order_header`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-12T01:54:27.198646Z", "completed_at": "2025-08-12T01:54:27.215878Z"}, {"name": "execute", "started_at": "2025-08-12T01:54:27.217809Z", "completed_at": "2025-08-12T01:54:28.822418Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.636967420578003, "adapter_response": {"_message": "OK", "query_id": "01f0771f-471a-1bb4-b366-b6e1235fb11c"}, "message": "OK", "failures": null, "unique_id": "model.dbt_checkpoint3_dw.stg_sales_customer_info", "compiled": true, "compiled_code": "with source as (\n    select * \n    from `ted_dev`.`bronze`.`raw_sqlserver_sales_customer_db`\n),\n\nrevised as (\n\n    select\n        CustomerID as customer_id\n        , PersonID as person_id\n        , StoreID as store_id\n        , TerritoryID as territory_id\n        , AccountNumber as account_number\n        , rowguid as row_guid\n        , cast(ModifiedDate as date) as modified_date\n    from source\n\n)\n\nselect * from revised", "relation_name": "`ted_dev`.`db_silver`.`stg_sales_customer_info`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-12T01:54:27.205692Z", "completed_at": "2025-08-12T01:54:27.220491Z"}, {"name": "execute", "started_at": "2025-08-12T01:54:27.225817Z", "completed_at": "2025-08-12T01:54:28.824489Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.6314332485198975, "adapter_response": {"_message": "OK", "query_id": "01f0771f-471b-1be5-aa45-eae338eeddda"}, "message": "OK", "failures": null, "unique_id": "model.dbt_checkpoint3_dw.stg_sales_order_detail", "compiled": true, "compiled_code": "with source as (\n    select * \n    from `ted_dev`.`bronze`.`raw_sqlserver_sales_salesorderdetail_db`\n),\n\nrevised as (\n\n    select\n        SalesOrderID         as order_id\n        , SalesOrderDetailID  as order_detail_id\n        , CarrierTrackingNumber as tracking_number\n        , OrderQty            as order_quantity\n        , ProductID           as product_id\n        , SpecialOfferID      as special_offer_id\n        , cast(UnitPrice as decimal (18,2))           as unit_price\n        , cast(UnitPriceDiscount as decimal(18,2))   as unit_price_discount\n        , cast(LineTotal as decimal(18,2))           as line_total\n        , rowguid            as row_guid\n        , cast(ModifiedDate as date)        as modified_date\n    from source\n\n)\n\nselect * from revised", "relation_name": "`ted_dev`.`db_silver`.`stg_sales_order_detail`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-12T01:54:28.780425Z", "completed_at": "2025-08-12T01:54:28.806143Z"}, {"name": "execute", "started_at": "2025-08-12T01:54:28.811125Z", "completed_at": "2025-08-12T01:54:30.070702Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.2976834774017334, "adapter_response": {"_message": "OK", "query_id": "01f0771f-4809-1223-bc9f-3adbecc24687"}, "message": "OK", "failures": null, "unique_id": "model.dbt_checkpoint3_dw.stg_sales_person_details", "compiled": true, "compiled_code": "with source as (\n    select * \n    from `ted_dev`.`bronze`.`raw_sqlserver_sales_vsalesperson_db`\n),\n\nrevised as (\n\n    select\n        BusinessEntityID as sales_person_id\n        , Title as title\n        , FirstName as first_name\n        , MiddleName as middle_name\n        , LastName as last_name\n        , Suffix as suffix\n        , JobTitle as job_title\n        , PhoneNumber as phone_number\n        , PhoneNumberType as phone_number_type\n        , EmailAddress as email_address\n        , EmailPromotion as email_promotion\n        , AddressLine1 as address_line_1\n        , AddressLine2 as address_line_2\n        , City as city\n        , StateProvinceName as state_province_name\n        , PostalCode as postal_code\n        , CountryRegionName as country_region_name\n        , TerritoryName as territory_id\n        , TerritoryGroup as territory_group\n        , cast(SalesQuota as decimal (18,2)) as sales_quota\n        , cast(SalesYTD as decimal (18,2)) as sales_ytd\n        , cast(SalesLastYear as decimal (18,2)) as sales_last_year\n    from source\n)\n\nselect * from revised", "relation_name": "`ted_dev`.`db_silver`.`stg_sales_person_details`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-12T01:54:28.852405Z", "completed_at": "2025-08-12T01:54:28.861457Z"}, {"name": "execute", "started_at": "2025-08-12T01:54:28.863705Z", "completed_at": "2025-08-12T01:54:30.170407Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.3278353214263916, "adapter_response": {"_message": "OK", "query_id": "01f0771f-480e-1395-9d6a-5b3df6257aee"}, "message": "OK", "failures": null, "unique_id": "model.dbt_checkpoint3_dw.stg_sales_ship_method", "compiled": true, "compiled_code": "with source as (\n    select * \n    from `ted_dev`.`bronze`.`raw_sqlserver_purchasing_shipmethod_db`\n),\n\nrevised as (\n\n    select\n        cast(ShipMethodID as bigint)         as ship_method_id\n        , cast(Name as  string)                as ship_method_name\n        , cast(ShipBase as decimal (18,2))             as ship_base\n        , cast(ShipRate as decimal (18,2))           as ship_rate\n        , cast(rowguid as string)             as row_guid\n        , cast(ModifiedDate as date)         as modified_date  \n\n    from source\n)\n\nselect * from revised", "relation_name": "`ted_dev`.`db_silver`.`stg_sales_ship_method`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-12T01:54:28.856107Z", "completed_at": "2025-08-12T01:54:28.868531Z"}, {"name": "execute", "started_at": "2025-08-12T01:54:28.870748Z", "completed_at": "2025-08-12T01:54:30.317128Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.4715194702148438, "adapter_response": {"_message": "OK", "query_id": "01f0771f-4810-11da-9a21-c4cfba25fe1a"}, "message": "OK", "failures": null, "unique_id": "model.dbt_checkpoint3_dw.stg_sales_territory", "compiled": true, "compiled_code": "with source as (\n    select * \n    from `ted_dev`.`bronze`.`raw_sqlserver_sales_salesterritory_db`\n),\n\nrevised as (\n\n    select\n        cast(TerritoryID as bigint)                 as territory_id\n        , cast(Name as string)                        as territory_name\n        , cast(CountryRegionCode as string)           as country_region_code\n        , cast(Group as string)                       as territory_group\n        , cast(SalesYTD as decimal(18,2))             as sales_ytd\n        , cast(SalesLastYear as decimal(18,2))        as sales_last_year\n        , cast(CostYTD as decimal(18,2))              as cost_ytd\n        , cast(CostLastYear as decimal(18,2))         as cost_last_year\n        , cast(rowguid as string)                     as row_guid\n        , cast(ModifiedDate as date)                  as modified_date\n\n    from source\n)\n\nselect * from revised", "relation_name": "`ted_dev`.`db_silver`.`stg_sales_territory`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-12T01:54:30.077358Z", "completed_at": "2025-08-12T01:54:30.082176Z"}, {"name": "execute", "started_at": "2025-08-12T01:54:30.083068Z", "completed_at": "2025-08-12T01:54:37.935182Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 7.859978437423706, "adapter_response": {"_message": "OK", "query_id": "01f0771f-48c4-1ce4-ba2c-0d1f10e415bb"}, "message": "OK", "failures": null, "unique_id": "model.dbt_checkpoint3_dw.dim_product", "compiled": true, "compiled_code": "with base as (\n    select \n        product_id,\n        product_name,\n        is_make,\n        is_finished_goods,\n        product_color,\n        standard_cost,\n        list_price,\n        product_line,\n        product_class,\n        product_style,\n        product_subcategory_id,\n        product_model_id\n    from `ted_dev`.`db_silver`.`stg_production_product_details`\n)\n\nselect * from base", "relation_name": "`ted_dev`.`db_gold`.`dim_product`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-12T01:54:23.061256Z", "completed_at": "2025-08-12T01:54:23.137599Z"}, {"name": "execute", "started_at": "2025-08-12T01:54:23.139911Z", "completed_at": "2025-08-12T01:54:37.957728Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 14.922425746917725, "adapter_response": {"_message": "OK", "query_id": "01f0771f-44df-1839-b60a-f9e9b834c130"}, "message": "OK", "failures": null, "unique_id": "model.dbt_checkpoint3_dw.dim_date", "compiled": true, "compiled_code": "\n\n\nwith date_spine as (\n\n    select\n        sequence(to_date('2000-01-01'), to_date('2030-12-31'), interval 1 day) as date_array\n\n),\n\nexploded as (\n\n    select explode(date_array) as date_day\n    from date_spine\n\n),\n\nfinal as (\n\n    select\n        date_day,\n        year(date_day) as year,\n        month(date_day) as month,\n        day(date_day) as day,\n        quarter(date_day) as quarter,\n        weekofyear(date_day) as week_of_year,\n        dayofweek(date_day) as day_of_week,\n        date_format(date_day, 'E') as day_name,\n        case when dayofweek(date_day) IN (1, 7) then true else false end as is_weekend\n\n    from exploded\n\n)\n\nselect * from final", "relation_name": "`ted_dev`.`db_gold`.`dim_date`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-12T01:54:30.322981Z", "completed_at": "2025-08-12T01:54:30.326400Z"}, {"name": "execute", "started_at": "2025-08-12T01:54:30.326770Z", "completed_at": "2025-08-12T01:54:37.974625Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 7.654163599014282, "adapter_response": {"_message": "OK", "query_id": "01f0771f-48e9-1cdd-9933-521154f9c680"}, "message": "OK", "failures": null, "unique_id": "model.dbt_checkpoint3_dw.dim_salesperson", "compiled": true, "compiled_code": "with base as (\n    select *\n    from `ted_dev`.`db_silver`.`stg_sales_person_details`\n),\n\nfinal as (\n    select\n        sales_person_id,\n\n        -- Nome completo com seguran\u00e7a contra campos nulos\n        trim(\n            concat_ws(' ',\n                coalesce(first_name, ''),\n                coalesce(middle_name, ''),\n                coalesce(last_name, '')\n            )\n        ) as full_name,\n\n        job_title,\n        email_address,\n\n        -- Limpeza de n\u00famero de telefone (tirando h\u00edfens)\n        regexp_replace(coalesce(phone_number, ''), '-', '') as phone_number,\n\n        -- Garantindo que os valores num\u00e9ricos estejam bem tratados\n        cast(sales_quota as double) as sales_quota,\n        cast(sales_ytd as double) as sales_ytd,\n        cast(sales_last_year as double) as sales_last_year,\n\n        territory_id,\n        territory_group,\n\n        -- Porcentagem da meta batida (com prote\u00e7\u00e3o contra divis\u00e3o por zero ou nulls)\n        case\n            when sales_quota is not null and sales_quota > 0\n                then round((sales_ytd / sales_quota) * 100, 2)\n            else null\n        end as percentual_meta_batida\n\n    from base\n)\n\nselect * from final", "relation_name": "`ted_dev`.`db_gold`.`dim_salesperson`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-12T01:54:30.176801Z", "completed_at": "2025-08-12T01:54:30.183317Z"}, {"name": "execute", "started_at": "2025-08-12T01:54:30.184327Z", "completed_at": "2025-08-12T01:54:42.111964Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 11.93688416481018, "adapter_response": {"_message": "OK", "query_id": "01f0771f-48d3-158a-8109-35cc654e15d8"}, "message": "OK", "failures": null, "unique_id": "model.dbt_checkpoint3_dw.fact_sales_order", "compiled": true, "compiled_code": "with order_detail as (\n    select *\n    from `ted_dev`.`db_silver`.`stg_sales_order_detail`\n),\n\norder_header as (\n    select *\n    from `ted_dev`.`db_silver`.`stg_sales_order_header`\n),\n\ncurrency_rate as (\n    select *\n    from `ted_dev`.`db_silver`.`stg_sales_currency_rate`\n),\n\njoined as (\n    select\n        -- IDs principais\n        od.order_id\n        , od.order_detail_id\n\n        -- Produto e oferta\n        , od.product_id\n\n        -- Cliente e vendedor\n        , oh.customer_id\n        , oh.sales_person_id\n        , oh.territory_id\n\n        -- Datas relevantes\n        , oh.order_date\n        , oh.due_date\n        , oh.ship_date\n\n        -- Informa\u00e7\u00f5es de envio e pagamento\n        , oh.ship_method_id\n        , oh.currency_rate_id\n\n        -- Quantidade e pre\u00e7o originais\n        , od.order_quantity\n        , od.unit_price\n        , od.unit_price_discount\n        , od.line_total\n\n        -- Valor convertido para USD usando average_rate\n        , (od.unit_price * cr.average_rate) as unit_price_usd\n\n        -- Receita bruta ajustada em USD\n        , (od.order_quantity * (od.unit_price * cr.average_rate) * (1 - od.unit_price_discount)) as gross_revenue_usd\n\n        -- Receita bruta ajustada original (sem considerar impostos ou frete)\n        , (od.order_quantity * od.unit_price * (1 - od.unit_price_discount)) as gross_revenue\n\n        -- Flags e rastreabilidade\n        , oh.is_online_order\n        , current_timestamp() as ingestion_timestamp\n\n    from order_detail od\n    left join order_header oh\n        on od.order_id = oh.order_id\n    left join currency_rate cr\n        on oh.currency_rate_id = cr.currency_rate_id\n)\n\nselect *\nfrom joined", "relation_name": "`ted_dev`.`db_gold`.`fact_sales_order`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-12T01:54:37.940426Z", "completed_at": "2025-08-12T01:54:37.943519Z"}, {"name": "execute", "started_at": "2025-08-12T01:54:37.943911Z", "completed_at": "2025-08-12T01:54:42.122962Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 4.1841630935668945, "adapter_response": {"_message": "OK", "query_id": "01f0771f-4d67-1350-8874-dd9633a35ee2"}, "message": "OK", "failures": null, "unique_id": "model.dbt_checkpoint3_dw.dim_ship_method", "compiled": true, "compiled_code": "with source as (\n    select *\n    from `ted_dev`.`db_silver`.`stg_sales_ship_method`\n),\n\nrenamed as (\n    select\n        ship_method_id,\n        ship_method_name,\n        ship_base,\n        ship_rate,\n        cast(modified_date as date) as modified_date\n    from source\n)\n\nselect * from renamed", "relation_name": "`ted_dev`.`db_gold`.`dim_ship_method`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-12T01:54:37.990815Z", "completed_at": "2025-08-12T01:54:37.994558Z"}, {"name": "execute", "started_at": "2025-08-12T01:54:37.994984Z", "completed_at": "2025-08-12T01:54:44.645656Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 6.66004204750061, "adapter_response": {"_message": "OK", "query_id": "01f0771f-4d6f-1fdb-b106-8fadaf6e427b"}, "message": "OK", "failures": null, "unique_id": "model.dbt_checkpoint3_dw.fact_sales_summary_monthly", "compiled": true, "compiled_code": "with orders as (\n    select\n        ord.order_id,\n        ord.territory_id,\n        terr.territory_name,\n        date_trunc('month', ord.order_date) as year_month,\n        ord.is_online_order,\n        ord.total_due,\n        ord.freight,\n        ord.tax_amount\n    from `ted_dev`.`db_silver`.`stg_sales_order_header` ord\n    left join `ted_dev`.`db_silver`.`stg_sales_territory` terr\n        on ord.territory_id = terr.territory_id\n),\n\norder_items as (\n    select\n        order_id,\n        sum(order_quantity) as total_items\n    from `ted_dev`.`db_silver`.`stg_sales_order_detail`\n    group by order_id\n),\n\njoined as (\n    select\n        o.year_month,\n        o.territory_id,\n        o.territory_name,\n        o.is_online_order,\n        o.total_due,\n        o.freight,\n        o.tax_amount,\n        i.total_items\n    from orders o\n    left join order_items i\n        on o.order_id = i.order_id\n),\n\naggregated as (\n    select\n        year_month,\n        territory_id,\n        territory_name,\n        is_online_order,\n        count(*) as total_orders,\n        sum(total_items) as total_items_sold,\n        sum(total_due) as revenue,\n        sum(freight) as freight_total,\n        sum(tax_amount) as tax_total,\n        round(sum(total_due) / nullif(count(*), 0), 2) as average_order_value\n    from joined\n    group by\n        year_month,\n        territory_id,\n        territory_name,\n        is_online_order\n)\n\nselect * from aggregated", "relation_name": "`ted_dev`.`db_gold`.`fact_sales_summary_monthly`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-12T01:54:37.965382Z", "completed_at": "2025-08-12T01:54:37.979041Z"}, {"name": "execute", "started_at": "2025-08-12T01:54:37.980462Z", "completed_at": "2025-08-12T01:54:44.916177Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 6.9537084102630615, "adapter_response": {"_message": "OK", "query_id": "01f0771f-4d6e-12a0-8f21-c9d0b1fbd2fd"}, "message": "OK", "failures": null, "unique_id": "model.dbt_checkpoint3_dw.dim_costumer", "compiled": true, "compiled_code": "with customer as (\n    select *\n    from `ted_dev`.`db_silver`.`stg_sales_customer_info`\n),\n\nperson as (\n    select *\n    from `ted_dev`.`db_silver`.`stg_person_person_details`\n),\n\nterritory as (\n    select *\n    from `ted_dev`.`db_silver`.`stg_sales_territory`\n),\n\njoined as (\n    select\n        cust.customer_id,\n        cust.person_id,\n        \n        -- Nome completo formatado\n        concat_ws(' ',\n            per.first_name,\n            per.middle_name,\n            per.last_name\n        ) as full_name,\n\n        -- Informa\u00e7\u00f5es do territ\u00f3rio\n        cust.territory_id,\n        terr.territory_name,\n        terr.territory_group,\n        terr.country_region_code\n\n    from customer cust\n    left join person per\n        on cust.person_id = per.person_id\n\n    left join territory terr\n        on cust.territory_id = terr.territory_id\n)\n\nselect * from joined", "relation_name": "`ted_dev`.`db_gold`.`dim_costumer`", "batch_results": null}], "elapsed_time": 28.267199993133545, "args": {"validate_macro_args": false, "select": [], "vars": {}, "macro_debugging": false, "quiet": false, "partial_parse": true, "populate_cache": true, "require_resource_names_without_spaces": true, "print": true, "printer_width": 80, "strict_mode": false, "empty": false, "invocation_command": "dbt run", "log_file_max_bytes": 10485760, "static_parser": true, "project_dir": "/home/alexandrersf/projects/checkpoint2_meltano/checkpoint2_meltano_code", "show_all_deprecations": false, "use_fast_test_edges": false, "introspect": true, "send_anonymous_usage_stats": true, "upload_to_artifacts_ingest_api": false, "log_path": "/home/alexandrersf/projects/checkpoint2_meltano/checkpoint2_meltano_code/logs", "log_format": "default", "require_explicit_package_overrides_for_builtin_materializations": true, "skip_nodes_if_on_run_start_fails": false, "use_colors": true, "require_batched_execution_for_custom_microbatch_strategy": false, "use_colors_file": true, "profiles_dir": "/home/alexandrersf/projects/checkpoint2_meltano/checkpoint2_meltano_code", "partial_parse_file_diff": true, "require_nested_cumulative_type_params": false, "favor_state": false, "show_resource_report": false, "defer": false, "require_yaml_configuration_for_mf_time_spines": false, "source_freshness_run_project_hooks": true, "version_check": true, "which": "run", "exclude": [], "indirect_selection": "eager", "log_level": "info", "require_all_warnings_handled_by_warn_error": false, "log_format_file": "debug", "warn_error_options": {"error": [], "warn": [], "silence": []}, "log_level_file": "debug", "state_modified_compare_vars": false, "write_json": true, "state_modified_compare_more_unrendered_values": false, "cache_selected_only": false}}