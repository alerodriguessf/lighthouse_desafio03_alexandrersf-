{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.2", "generated_at": "2025-07-19T19:46:56.913900Z", "invocation_id": "19f6b34d-1071-40f8-a549-58312f0e77a5", "invocation_started_at": "2025-07-19T19:46:41.926004Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-19T19:46:46.431495Z", "completed_at": "2025-07-19T19:46:46.447872Z"}, {"name": "execute", "started_at": "2025-07-19T19:46:46.479701Z", "completed_at": "2025-07-19T19:46:47.368783Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.9582061767578125, "adapter_response": {"_message": "OK", "query_id": "01f064d9-1a89-1a24-a549-244cb1d295c9"}, "message": "OK", "failures": null, "unique_id": "model.dbt_checkpoint3_dw.stg_person_person_details", "compiled": true, "compiled_code": "with source as (\n    select * \n    from `ted_dev`.`bronze`.`raw_sqlserver_person_person_db`\n),\n\nrevised as (\n\n    select\n        BusinessEntityID as person_id,\n        PersonType as person_type,\n        cast(NameStyle as boolean) as name_style,\n        Title as title,\n        FirstName as first_name,\n        MiddleName as middle_name,\n        LastName as last_name,\n        Suffix as suffix,\n        EmailPromotion as email_promotion,\n        AdditionalContactInfo as additional_contact_info,\n        Demographics as demographics,\n        rowguid as row_guid,\n        cast(ModifiedDate as date) as modified_date\n    from source\n\n)\n\nselect * from revised", "relation_name": "`ted_dev`.`db_silver`.`stg_person_person_details`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-19T19:46:47.380826Z", "completed_at": "2025-07-19T19:46:47.386410Z"}, {"name": "execute", "started_at": "2025-07-19T19:46:47.387934Z", "completed_at": "2025-07-19T19:46:48.119963Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.7424061298370361, "adapter_response": {"_message": "OK", "query_id": "01f064d9-1afd-17b5-9dd2-e2612603340f"}, "message": "OK", "failures": null, "unique_id": "model.dbt_checkpoint3_dw.stg_sales_customer_info", "compiled": true, "compiled_code": "with source as (\n    select * \n    from `ted_dev`.`bronze`.`raw_sqlserver_sales_customer_db`\n),\n\nrevised as (\n\n    select\n        CustomerID as customer_id,\n        PersonID as person_id,\n        StoreID as store_id,\n        TerritoryID as territory_id,\n        AccountNumber as account_number,\n        rowguid as row_guid,\n        cast(ModifiedDate as date) as modified_date\n    from source\n\n)\n\nselect * from revised", "relation_name": "`ted_dev`.`db_silver`.`stg_sales_customer_info`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-19T19:46:46.442224Z", "completed_at": "2025-07-19T19:46:46.477778Z"}, {"name": "execute", "started_at": "2025-07-19T19:46:46.512578Z", "completed_at": "2025-07-19T19:46:48.419178Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 2.003424644470215, "adapter_response": {"_message": "OK", "query_id": "01f064d9-1b16-1c36-b6c4-3b829a1ba514"}, "message": "OK", "failures": null, "unique_id": "model.dbt_checkpoint3_dw.stg_sales_currency_rate", "compiled": true, "compiled_code": "with source as (\n    select * \n    from `ted_dev`.`bronze`.`raw_sqlserver_sales_currencyrate_db`\n),\n\nrevised as (\n    select\n        CurrencyRateID as currency_rate_id,\n        cast(CurrencyRateDate as date) as currency_rate_date,\n        FromCurrencyCode as from_currency_code,\n        ToCurrencyCode as to_currency_code,\n        cast(AverageRate as decimal(18,2)) as average_rate,\n        cast(EndOfDayRate as decimal(18,2)) as end_of_day_rate,\n        cast(ModifiedDate as date) as modified_date\n    from source\n)\n\nselect * from revised", "relation_name": "`ted_dev`.`db_silver`.`stg_sales_currency_rate`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-19T19:46:46.436139Z", "completed_at": "2025-07-19T19:46:46.449974Z"}, {"name": "execute", "started_at": "2025-07-19T19:46:46.491025Z", "completed_at": "2025-07-19T19:46:48.512930Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 2.100159168243408, "adapter_response": {"_message": "OK", "query_id": "01f064d9-1b18-1863-accc-c0339f133fcf"}, "message": "OK", "failures": null, "unique_id": "model.dbt_checkpoint3_dw.stg_production_product_details", "compiled": true, "compiled_code": "with source as (\n    select * \n    from `ted_dev`.`bronze`.`raw_sqlserver_production_product_db`\n),\n\nrevised as (\n\n    select\n        ProductID         as product_id,\n        Name              as product_name,\n        ProductNumber     as product_number,\n        MakeFlag         as is_make,\n        FinishedGoodsFlag as is_finished_goods,\n        Color             as product_color,\n        SafetyStockLevel  as safety_stock_level,\n        ReorderPoint      as reorder_point,\n        cast(StandardCost as decimal(18,2))      as standard_cost,\n        cast(ListPrice as decimal(18,2))         as list_price,\n        Size              as product_size,\n        SizeUnitMeasureCode as size_unit_measure_code,\n        WeightUnitMeasureCode as weight_unit_measure_code,\n        Weight            as product_weight,\n        DaysToManufacture as days_to_manufacture,\n        ProductLine       as product_line,\n        Class             as product_class,\n        Style             as product_style,\n        ProductSubcategoryID as product_subcategory_id,\n        ProductModelID    as product_model_id,\n        cast(SellStartDate as date)     as sell_start_date,\n        cast(SellEndDate as date)       as sell_end_date,\n        cast(DiscontinuedDate as date)  as discontinued_date,\n        rowguid           as row_guid,\n        cast(ModifiedDate as date)      as modified_date\n\n    from source\n\n)\n\nselect * from revised", "relation_name": "`ted_dev`.`db_silver`.`stg_production_product_details`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-19T19:46:46.421399Z", "completed_at": "2025-07-19T19:46:46.447109Z"}, {"name": "execute", "started_at": "2025-07-19T19:46:46.450933Z", "completed_at": "2025-07-19T19:46:48.857165Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.4477522373199463, "adapter_response": {"_message": "OK", "query_id": "01f064d9-1a88-1948-95c8-fdfd91233105"}, "message": "OK", "failures": null, "unique_id": "model.dbt_checkpoint3_dw.dim_date", "compiled": true, "compiled_code": "\n\n\nwith date_spine as (\n\n    select\n        sequence(to_date('2000-01-01'), to_date('2030-12-31'), interval 1 day) as date_array\n\n),\n\nexploded as (\n\n    select explode(date_array) as date_day\n    from date_spine\n\n),\n\nfinal as (\n\n    select\n        date_day,\n        year(date_day) as year,\n        month(date_day) as month,\n        day(date_day) as day,\n        quarter(date_day) as quarter,\n        weekofyear(date_day) as week_of_year,\n        dayofweek(date_day) as day_of_week,\n        date_format(date_day, 'E') as day_name,\n        case when dayofweek(date_day) IN (1, 7) then true else false end as is_weekend\n\n    from exploded\n\n)\n\nselect * from final", "relation_name": "`ted_dev`.`db_gold`.`dim_date`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-19T19:46:48.125874Z", "completed_at": "2025-07-19T19:46:48.129153Z"}, {"name": "execute", "started_at": "2025-07-19T19:46:48.129548Z", "completed_at": "2025-07-19T19:46:48.906449Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.7830245494842529, "adapter_response": {"_message": "OK", "query_id": "01f064d9-1b64-153e-9bca-d881861d37cb"}, "message": "OK", "failures": null, "unique_id": "model.dbt_checkpoint3_dw.stg_sales_order_detail", "compiled": true, "compiled_code": "with source as (\n    select * \n    from `ted_dev`.`bronze`.`raw_sqlserver_sales_salesorderdetail_db`\n),\n\nrevised as (\n\n    select\n        SalesOrderID         as order_id,\n        SalesOrderDetailID  as order_detail_id,\n        CarrierTrackingNumber as tracking_number,\n        OrderQty            as order_quantity,\n        ProductID           as product_id,\n        SpecialOfferID      as special_offer_id,\n        cast(UnitPrice as decimal (18,2))           as unit_price,\n        cast(UnitPriceDiscount as decimal(18,2))   as unit_price_discount,\n        cast(LineTotal as decimal(18,2))           as line_total,\n        rowguid            as row_guid,\n        cast(ModifiedDate as date)        as modified_date\n    from source\n\n)\n\nselect * from revised", "relation_name": "`ted_dev`.`db_silver`.`stg_sales_order_detail`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-19T19:46:48.424612Z", "completed_at": "2025-07-19T19:46:48.429478Z"}, {"name": "execute", "started_at": "2025-07-19T19:46:48.430097Z", "completed_at": "2025-07-19T19:46:49.152163Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.7294206619262695, "adapter_response": {"_message": "OK", "query_id": "01f064d9-1b8f-1d83-ac0f-c96516d93826"}, "message": "OK", "failures": null, "unique_id": "model.dbt_checkpoint3_dw.stg_sales_order_header", "compiled": true, "compiled_code": "with source as (\n    select * \n    from `ted_dev`.`bronze`.`raw_sqlserver_sales_salesorderheader_db`\n),\n\nrenamed as (\n\n    select\n        SalesOrderID         as order_id,\n        RevisionNumber       as nm_revisao,\n        cast(OrderDate as date)           as order_date,\n        cast(DueDate as date)             as due_date,\n        cast(ShipDate as date)            as ship_date,\n        OnlineOrderFlag    as is_online_order,\n        SalesOrderNumber    as order_number,\n        PurchaseOrderNumber as purchase_order_number,\n        AccountNumber       as account_number,\n        CustomerID          as customer_id,\n        SalesPersonID       as sales_person_id,\n        TerritoryID         as territory_id,\n        BillToAddressID     as bill_to_address_id,\n        ShipToAddressID     as ship_to_address_id,\n        ShipMethodID        as ship_method_id,\n        CreditCardID        as credit_card_id,\n        CreditCardApprovalCode as credit_card_approval_code,\n        CurrencyRateID      as currency_rate_id,\n        cast(SubTotal as decimal(18,2))            as sub_total,\n        cast(TaxAmt as decimal(18,2))              as tax_amount,\n        cast(Freight as decimal(18,2))             as freight,\n        cast(TotalDue as decimal(18,2))            as total_due,\n        Comment             as comment,\n        rowguid            as row_guid,\n        cast(ModifiedDate as date)        as modified_date\n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "`ted_dev`.`db_silver`.`stg_sales_order_header`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-19T19:46:48.519892Z", "completed_at": "2025-07-19T19:46:48.525970Z"}, {"name": "execute", "started_at": "2025-07-19T19:46:48.526760Z", "completed_at": "2025-07-19T19:46:49.260272Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.7429871559143066, "adapter_response": {"_message": "OK", "query_id": "01f064d9-1b9e-1a6f-8eb3-e02d8c30e6b5"}, "message": "OK", "failures": null, "unique_id": "model.dbt_checkpoint3_dw.stg_sales_person_details", "compiled": true, "compiled_code": "with source as (\n    select * \n    from `ted_dev`.`bronze`.`raw_sqlserver_sales_vsalesperson_db`\n),\n\nrevised as (\n\n    select\n        BusinessEntityID as sales_person_id,\n        Title as title,\n        FirstName as first_name,\n        MiddleName as middle_name,\n        LastName as last_name,\n        Suffix as suffix,\n        JobTitle as job_title,\n        PhoneNumber as phone_number,\n        PhoneNumberType as phone_number_type,\n        EmailAddress as email_address,\n        EmailPromotion as email_promotion,\n        AddressLine1 as address_line_1,\n        AddressLine2 as address_line_2,\n        City as city,\n        StateProvinceName as state_province_name,\n        PostalCode as postal_code,\n        CountryRegionName as country_region_name,\n        TerritoryName as territory_id,\n        TerritoryGroup as territory_group,\n        cast(SalesQuota as decimal (18,2)) as sales_quota,\n        cast(SalesYTD as decimal (18,2)) as sales_ytd,\n        cast(SalesLastYear as decimal (18,2)) as sales_last_year\n    from source\n)\n\nselect * from revised", "relation_name": "`ted_dev`.`db_silver`.`stg_sales_person_details`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-19T19:46:48.863050Z", "completed_at": "2025-07-19T19:46:48.869078Z"}, {"name": "execute", "started_at": "2025-07-19T19:46:48.869916Z", "completed_at": "2025-07-19T19:46:49.593207Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.7319769859313965, "adapter_response": {"_message": "OK", "query_id": "01f064d9-1bcf-1feb-b56a-b5da2f1fae2f"}, "message": "OK", "failures": null, "unique_id": "model.dbt_checkpoint3_dw.stg_sales_ship_method", "compiled": true, "compiled_code": "with source as (\n    select * \n    from `ted_dev`.`bronze`.`raw_sqlserver_purchasing_shipmethod_db`\n),\n\nrevised as (\n\n    select\n        cast(ShipMethodID as bigint)         as ship_method_id,\n        cast(Name as  string)                as ship_method_name,\n        cast(ShipBase as decimal (18,2))             as ship_base,\n        cast(ShipRate as decimal (18,2))           as ship_rate,\n        cast(rowguid as string)             as row_guid,\n        cast(ModifiedDate as date)         as modified_date  \n\n    from source\n)\n\nselect * from revised", "relation_name": "`ted_dev`.`db_silver`.`stg_sales_ship_method`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-19T19:46:48.914230Z", "completed_at": "2025-07-19T19:46:48.918151Z"}, {"name": "execute", "started_at": "2025-07-19T19:46:48.919270Z", "completed_at": "2025-07-19T19:46:49.654287Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.7416720390319824, "adapter_response": {"_message": "OK", "query_id": "01f064d9-1bd7-16d4-803a-eb0c93d16767"}, "message": "OK", "failures": null, "unique_id": "model.dbt_checkpoint3_dw.stg_sales_territory", "compiled": true, "compiled_code": "with source as (\n    select * \n    from `ted_dev`.`bronze`.`raw_sqlserver_sales_salesterritory_db`\n),\n\nrevised as (\n\n    select\n        cast(TerritoryID as bigint)                 as territory_id,\n        cast(Name as string)                        as territory_name,\n        cast(CountryRegionCode as string)           as country_region_code,\n        cast(Group as string)                       as territory_group,\n        cast(SalesYTD as decimal(18,2))             as sales_ytd,\n        cast(SalesLastYear as decimal(18,2))        as sales_last_year,\n        cast(CostYTD as decimal(18,2))              as cost_ytd,\n        cast(CostLastYear as decimal(18,2))         as cost_last_year,\n        cast(rowguid as string)                     as row_guid,\n        cast(ModifiedDate as date)                  as modified_date\n\n    from source\n)\n\nselect * from revised", "relation_name": "`ted_dev`.`db_silver`.`stg_sales_territory`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-19T19:46:49.157283Z", "completed_at": "2025-07-19T19:46:49.262329Z"}, {"name": "execute", "started_at": "2025-07-19T19:46:49.264754Z", "completed_at": "2025-07-19T19:46:51.899785Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 2.743971347808838, "adapter_response": {"_message": "OK", "query_id": "01f064d9-1c09-1ea9-b221-962e2bbf88ec"}, "message": "OK", "failures": null, "unique_id": "model.dbt_checkpoint3_dw.dim_product", "compiled": true, "compiled_code": "with base as (\n    select \n        product_id,\n        product_name,\n        is_make,\n        is_finished_goods,\n        product_color,\n        standard_cost,\n        list_price,\n        product_line,\n        product_class,\n        product_style,\n        product_subcategory_id,\n        product_model_id\n    from `ted_dev`.`db_silver`.`stg_production_product_details`\n)\n\nselect * from base", "relation_name": "`ted_dev`.`db_gold`.`dim_product`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-19T19:46:49.661770Z", "completed_at": "2025-07-19T19:46:49.665649Z"}, {"name": "execute", "started_at": "2025-07-19T19:46:49.666315Z", "completed_at": "2025-07-19T19:46:52.606953Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 2.947099447250366, "adapter_response": {"_message": "OK", "query_id": "01f064d9-1c44-1be4-b81b-057bd37e1a59"}, "message": "OK", "failures": null, "unique_id": "model.dbt_checkpoint3_dw.dim_ship_method", "compiled": true, "compiled_code": "with source as (\n    select *\n    from `ted_dev`.`db_silver`.`stg_sales_ship_method`\n),\n\nrenamed as (\n    select\n        ship_method_id,\n        ship_method_name,\n        ship_base,\n        ship_rate,\n        cast(modified_date as date) as modified_date\n    from source\n)\n\nselect * from renamed", "relation_name": "`ted_dev`.`db_gold`.`dim_ship_method`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-19T19:46:49.598211Z", "completed_at": "2025-07-19T19:46:49.601631Z"}, {"name": "execute", "started_at": "2025-07-19T19:46:49.602831Z", "completed_at": "2025-07-19T19:46:52.632211Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.036147117614746, "adapter_response": {"_message": "OK", "query_id": "01f064d9-1c3a-1798-88b1-2d8664974e43"}, "message": "OK", "failures": null, "unique_id": "model.dbt_checkpoint3_dw.dim_salesperson", "compiled": true, "compiled_code": "with base as (\n    select *\n    from `ted_dev`.`db_silver`.`stg_sales_person_details`\n),\n\nfinal as (\n    select\n        sales_person_id,\n\n        -- Nome completo com seguran\u00e7a contra campos nulos\n        trim(\n            concat_ws(' ',\n                coalesce(first_name, ''),\n                coalesce(middle_name, ''),\n                coalesce(last_name, '')\n            )\n        ) as full_name,\n\n        job_title,\n        email_address,\n\n        -- Limpeza de n\u00famero de telefone (tirando h\u00edfens)\n        regexp_replace(coalesce(phone_number, ''), '-', '') as phone_number,\n\n        -- Garantindo que os valores num\u00e9ricos estejam bem tratados\n        cast(sales_quota as double) as sales_quota,\n        cast(sales_ytd as double) as sales_ytd,\n        cast(sales_last_year as double) as sales_last_year,\n\n        territory_id,\n        territory_group,\n\n        -- Porcentagem da meta batida (com prote\u00e7\u00e3o contra divis\u00e3o por zero ou nulls)\n        case\n            when sales_quota is not null and sales_quota > 0\n                then round((sales_ytd / sales_quota) * 100, 2)\n            else null\n        end as percentual_meta_batida\n\n    from base\n)\n\nselect * from final", "relation_name": "`ted_dev`.`db_gold`.`dim_salesperson`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-19T19:46:49.275401Z", "completed_at": "2025-07-19T19:46:49.281218Z"}, {"name": "execute", "started_at": "2025-07-19T19:46:49.281857Z", "completed_at": "2025-07-19T19:46:53.183767Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 3.9114224910736084, "adapter_response": {"_message": "OK", "query_id": "01f064d9-1c0a-1c53-a4dc-11e01bdb00d6"}, "message": "OK", "failures": null, "unique_id": "model.dbt_checkpoint3_dw.fact_sales_order", "compiled": true, "compiled_code": "with order_detail as (\n    select *\n    from `ted_dev`.`db_silver`.`stg_sales_order_detail`\n),\n\norder_header as (\n    select *\n    from `ted_dev`.`db_silver`.`stg_sales_order_header`\n),\n\njoined as (\n    select\n        -- IDs principais\n        od.order_id,\n        od.order_detail_id,\n\n        -- Produto e oferta\n        od.product_id,\n\n        -- Cliente e vendedor\n        oh.customer_id,\n        oh.sales_person_id,\n        oh.territory_id,\n\n        -- Datas relevantes\n        oh.order_date,\n        oh.due_date,\n        oh.ship_date,\n\n        -- Informa\u00e7\u00f5es de envio e pagamento\n        oh.ship_method_id,\n        oh.currency_rate_id,\n\n        -- Quantidade e pre\u00e7o\n        od.order_quantity,\n        od.unit_price,\n        od.unit_price_discount,\n        od.line_total,\n\n        -- Receita bruta ajustada (sem considerar impostos ou frete)\n        (od.order_quantity * od.unit_price * (1 - od.unit_price_discount)) as gross_revenue,\n\n        -- Flags e rastreabilidade\n        oh.is_online_order,\n        current_timestamp() as ingestion_timestamp\n\n    from order_detail od\n    left join order_header oh\n        on od.order_id = oh.order_id\n)\n\nselect * from joined", "relation_name": "`ted_dev`.`db_gold`.`fact_sales_order`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-19T19:46:51.905794Z", "completed_at": "2025-07-19T19:46:51.909623Z"}, {"name": "execute", "started_at": "2025-07-19T19:46:51.910136Z", "completed_at": "2025-07-19T19:46:55.188180Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 3.2843570709228516, "adapter_response": {"_message": "OK", "query_id": "01f064d9-1d89-1d28-bf96-f3c48e64369b"}, "message": "OK", "failures": null, "unique_id": "model.dbt_checkpoint3_dw.dim_costumer", "compiled": true, "compiled_code": "with customer as (\n    select *\n    from `ted_dev`.`db_silver`.`stg_sales_customer_info`\n),\n\nperson as (\n    select *\n    from `ted_dev`.`db_silver`.`stg_person_person_details`\n),\n\nterritory as (\n    select *\n    from `ted_dev`.`db_silver`.`stg_sales_territory`\n),\n\njoined as (\n    select\n        cust.customer_id,\n        cust.person_id,\n        \n        -- Nome completo formatado\n        concat_ws(' ',\n            per.first_name,\n            per.middle_name,\n            per.last_name\n        ) as full_name,\n\n        -- Informa\u00e7\u00f5es do territ\u00f3rio\n        cust.territory_id,\n        terr.territory_name,\n        terr.territory_group,\n        terr.country_region_code\n\n    from customer cust\n    left join person per\n        on cust.person_id = per.person_id\n\n    left join territory terr\n        on cust.territory_id = terr.territory_id\n)\n\nselect * from joined", "relation_name": "`ted_dev`.`db_gold`.`dim_costumer`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-19T19:46:52.612320Z", "completed_at": "2025-07-19T19:46:52.616342Z"}, {"name": "execute", "started_at": "2025-07-19T19:46:52.616921Z", "completed_at": "2025-07-19T19:46:55.870002Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 3.2594993114471436, "adapter_response": {"_message": "OK", "query_id": "01f064d9-1def-1200-b72e-f4f05b5cead6"}, "message": "OK", "failures": null, "unique_id": "model.dbt_checkpoint3_dw.fact_sales_summary_monthly", "compiled": true, "compiled_code": "with orders as (\n    select\n        ord.order_id,\n        ord.territory_id,\n        terr.territory_name,\n        date_trunc('month', ord.order_date) as year_month,\n        ord.is_online_order,\n        ord.total_due,\n        ord.freight,\n        ord.tax_amount\n    from `ted_dev`.`db_silver`.`stg_sales_order_header` ord\n    left join `ted_dev`.`db_silver`.`stg_sales_territory` terr\n        on ord.territory_id = terr.territory_id\n),\n\norder_items as (\n    select\n        order_id,\n        sum(order_quantity) as total_items\n    from `ted_dev`.`db_silver`.`stg_sales_order_detail`\n    group by order_id\n),\n\njoined as (\n    select\n        o.year_month,\n        o.territory_id,\n        o.territory_name,\n        o.is_online_order,\n        o.total_due,\n        o.freight,\n        o.tax_amount,\n        i.total_items\n    from orders o\n    left join order_items i\n        on o.order_id = i.order_id\n),\n\naggregated as (\n    select\n        year_month,\n        territory_id,\n        territory_name,\n        is_online_order,\n        count(*) as total_orders,\n        sum(total_items) as total_items_sold,\n        sum(total_due) as revenue,\n        sum(freight) as freight_total,\n        sum(tax_amount) as tax_total,\n        round(sum(total_due) / nullif(count(*), 0), 2) as average_order_value\n    from joined\n    group by\n        year_month,\n        territory_id,\n        territory_name,\n        is_online_order\n)\n\nselect * from aggregated", "relation_name": "`ted_dev`.`db_gold`.`fact_sales_summary_monthly`", "batch_results": null}], "elapsed_time": 12.588719606399536, "args": {"favor_state": false, "print": true, "use_colors_file": true, "introspect": true, "log_file_max_bytes": 10485760, "write_json": true, "partial_parse": true, "exclude": [], "log_format_file": "debug", "use_fast_test_edges": false, "strict_mode": false, "static_parser": true, "require_nested_cumulative_type_params": false, "macro_debugging": false, "state_modified_compare_vars": false, "log_path": "/home/alexandrersf/projects/checkpoint2_meltano/checkpoint2_meltano_code/logs", "require_all_warnings_handled_by_warn_error": false, "printer_width": 80, "show_resource_report": false, "skip_nodes_if_on_run_start_fails": false, "vars": {}, "warn_error_options": {"error": [], "warn": [], "silence": []}, "state_modified_compare_more_unrendered_values": false, "version_check": true, "quiet": false, "require_batched_execution_for_custom_microbatch_strategy": false, "upload_to_artifacts_ingest_api": false, "project_dir": "/home/alexandrersf/projects/checkpoint2_meltano/checkpoint2_meltano_code", "indirect_selection": "eager", "cache_selected_only": false, "require_resource_names_without_spaces": true, "validate_macro_args": false, "use_colors": true, "invocation_command": "dbt run", "select": [], "source_freshness_run_project_hooks": true, "which": "run", "empty": false, "log_format": "default", "log_level": "info", "require_explicit_package_overrides_for_builtin_materializations": true, "profiles_dir": "/home/alexandrersf/projects/checkpoint2_meltano/checkpoint2_meltano_code", "log_level_file": "debug", "require_yaml_configuration_for_mf_time_spines": false, "send_anonymous_usage_stats": true, "defer": false, "show_all_deprecations": false, "partial_parse_file_diff": true, "populate_cache": true}}