{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.2", "generated_at": "2025-07-19T21:46:53.606461Z", "invocation_id": "aa3bb805-fc7e-4580-8d84-63a4232c3fb3", "invocation_started_at": "2025-07-19T21:46:46.381897Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-19T21:46:52.832336Z", "completed_at": "2025-07-19T21:46:52.851840Z"}, {"name": "execute", "started_at": "2025-07-19T21:46:52.856665Z", "completed_at": "2025-07-19T21:46:52.856729Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03237271308898926, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_checkpoint3_dw.dim_date", "compiled": true, "compiled_code": "\n\n\nwith date_spine as (\n\n    select\n        sequence(to_date('2000-01-01'), to_date('2030-12-31'), interval 1 day) as date_array\n\n),\n\nexploded as (\n\n    select explode(date_array) as date_day\n    from date_spine\n\n),\n\nfinal as (\n\n    select\n        date_day,\n        year(date_day) as year,\n        month(date_day) as month,\n        day(date_day) as day,\n        quarter(date_day) as quarter,\n        weekofyear(date_day) as week_of_year,\n        dayofweek(date_day) as day_of_week,\n        date_format(date_day, 'E') as day_name,\n        case when dayofweek(date_day) IN (1, 7) then true else false end as is_weekend\n\n    from exploded\n\n)\n\nselect * from final", "relation_name": "`ted_dev`.`db_gold`.`dim_date`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-19T21:46:52.841155Z", "completed_at": "2025-07-19T21:46:52.854196Z"}, {"name": "execute", "started_at": "2025-07-19T21:46:52.858230Z", "completed_at": "2025-07-19T21:46:52.858245Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03217267990112305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_checkpoint3_dw.stg_person_person_details", "compiled": true, "compiled_code": "with source as (\n    select * \n    from `ted_dev`.`bronze`.`raw_sqlserver_person_person_db`\n),\n\nrevised as (\n\n    select\n        BusinessEntityID as person_id,\n        PersonType as person_type,\n        cast(NameStyle as boolean) as name_style,\n        Title as title,\n        FirstName as first_name,\n        MiddleName as middle_name,\n        LastName as last_name,\n        Suffix as suffix,\n        EmailPromotion as email_promotion,\n        AdditionalContactInfo as additional_contact_info,\n        Demographics as demographics,\n        rowguid as row_guid,\n        cast(ModifiedDate as date) as modified_date\n    from source\n\n)\n\nselect * from revised", "relation_name": "`ted_dev`.`db_silver`.`stg_person_person_details`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-19T21:46:52.844293Z", "completed_at": "2025-07-19T21:46:52.855168Z"}, {"name": "execute", "started_at": "2025-07-19T21:46:52.859046Z", "completed_at": "2025-07-19T21:46:52.859058Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03223061561584473, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_checkpoint3_dw.stg_production_product_details", "compiled": true, "compiled_code": "with source as (\n    select * \n    from `ted_dev`.`bronze`.`raw_sqlserver_production_product_db`\n),\n\nrevised as (\n\n    select\n        ProductID         as product_id,\n        Name              as product_name,\n        ProductNumber     as product_number,\n        MakeFlag         as is_make,\n        FinishedGoodsFlag as is_finished_goods,\n        Color             as product_color,\n        SafetyStockLevel  as safety_stock_level,\n        ReorderPoint      as reorder_point,\n        cast(StandardCost as decimal(18,2))      as standard_cost,\n        cast(ListPrice as decimal(18,2))         as list_price,\n        Size              as product_size,\n        SizeUnitMeasureCode as size_unit_measure_code,\n        WeightUnitMeasureCode as weight_unit_measure_code,\n        Weight            as product_weight,\n        DaysToManufacture as days_to_manufacture,\n        ProductLine       as product_line,\n        Class             as product_class,\n        Style             as product_style,\n        ProductSubcategoryID as product_subcategory_id,\n        ProductModelID    as product_model_id,\n        cast(SellStartDate as date)     as sell_start_date,\n        cast(SellEndDate as date)       as sell_end_date,\n        cast(DiscontinuedDate as date)  as discontinued_date,\n        rowguid           as row_guid,\n        cast(ModifiedDate as date)      as modified_date\n\n    from source\n\n)\n\nselect * from revised", "relation_name": "`ted_dev`.`db_silver`.`stg_production_product_details`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-19T21:46:52.847879Z", "completed_at": "2025-07-19T21:46:52.855922Z"}, {"name": "execute", "started_at": "2025-07-19T21:46:52.859782Z", "completed_at": "2025-07-19T21:46:52.859794Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03171229362487793, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_checkpoint3_dw.stg_sales_currency_rate", "compiled": true, "compiled_code": "with source as (\n    select * \n    from `ted_dev`.`bronze`.`raw_sqlserver_sales_currencyrate_db`\n),\n\nrevised as (\n    select\n        CurrencyRateID as currency_rate_id,\n        cast(CurrencyRateDate as date) as currency_rate_date,\n        FromCurrencyCode as from_currency_code,\n        ToCurrencyCode as to_currency_code,\n        cast(AverageRate as decimal(18,2)) as average_rate,\n        cast(EndOfDayRate as decimal(18,2)) as end_of_day_rate,\n        cast(ModifiedDate as date) as modified_date\n    from source\n)\n\nselect * from revised", "relation_name": "`ted_dev`.`db_silver`.`stg_sales_currency_rate`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-19T21:46:52.874709Z", "completed_at": "2025-07-19T21:46:52.886944Z"}, {"name": "execute", "started_at": "2025-07-19T21:46:52.888958Z", "completed_at": "2025-07-19T21:46:52.888973Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.024646520614624023, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_checkpoint3_dw.stg_sales_order_detail", "compiled": true, "compiled_code": "with source as (\n    select * \n    from `ted_dev`.`bronze`.`raw_sqlserver_sales_salesorderdetail_db`\n),\n\nrevised as (\n\n    select\n        SalesOrderID         as order_id,\n        SalesOrderDetailID  as order_detail_id,\n        CarrierTrackingNumber as tracking_number,\n        OrderQty            as order_quantity,\n        ProductID           as product_id,\n        SpecialOfferID      as special_offer_id,\n        cast(UnitPrice as decimal (18,2))           as unit_price,\n        cast(UnitPriceDiscount as decimal(18,2))   as unit_price_discount,\n        cast(LineTotal as decimal(18,2))           as line_total,\n        rowguid            as row_guid,\n        cast(ModifiedDate as date)        as modified_date\n    from source\n\n)\n\nselect * from revised", "relation_name": "`ted_dev`.`db_silver`.`stg_sales_order_detail`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-19T21:46:52.871262Z", "completed_at": "2025-07-19T21:46:52.887729Z"}, {"name": "execute", "started_at": "2025-07-19T21:46:52.891618Z", "completed_at": "2025-07-19T21:46:52.891634Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.027874231338500977, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_checkpoint3_dw.stg_sales_customer_info", "compiled": true, "compiled_code": "with source as (\n    select * \n    from `ted_dev`.`bronze`.`raw_sqlserver_sales_customer_db`\n),\n\nrevised as (\n\n    select\n        CustomerID as customer_id,\n        PersonID as person_id,\n        StoreID as store_id,\n        TerritoryID as territory_id,\n        AccountNumber as account_number,\n        rowguid as row_guid,\n        cast(ModifiedDate as date) as modified_date\n    from source\n\n)\n\nselect * from revised", "relation_name": "`ted_dev`.`db_silver`.`stg_sales_customer_info`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-19T21:46:52.877836Z", "completed_at": "2025-07-19T21:46:52.890832Z"}, {"name": "execute", "started_at": "2025-07-19T21:46:52.894509Z", "completed_at": "2025-07-19T21:46:52.894561Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.029656648635864258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_checkpoint3_dw.stg_sales_order_header", "compiled": true, "compiled_code": "with source as (\n    select * \n    from `ted_dev`.`bronze`.`raw_sqlserver_sales_salesorderheader_db`\n),\n\nrenamed as (\n\n    select\n        SalesOrderID         as order_id,\n        RevisionNumber       as nm_revisao,\n        cast(OrderDate as date)           as order_date,\n        cast(DueDate as date)             as due_date,\n        cast(ShipDate as date)            as ship_date,\n        OnlineOrderFlag    as is_online_order,\n        SalesOrderNumber    as order_number,\n        PurchaseOrderNumber as purchase_order_number,\n        AccountNumber       as account_number,\n        CustomerID          as customer_id,\n        SalesPersonID       as sales_person_id,\n        TerritoryID         as territory_id,\n        BillToAddressID     as bill_to_address_id,\n        ShipToAddressID     as ship_to_address_id,\n        ShipMethodID        as ship_method_id,\n        CreditCardID        as credit_card_id,\n        CreditCardApprovalCode as credit_card_approval_code,\n        CurrencyRateID      as currency_rate_id,\n        cast(SubTotal as decimal(18,2))            as sub_total,\n        cast(TaxAmt as decimal(18,2))              as tax_amount,\n        cast(Freight as decimal(18,2))             as freight,\n        cast(TotalDue as decimal(18,2))            as total_due,\n        Comment             as comment,\n        rowguid            as row_guid,\n        cast(ModifiedDate as date)        as modified_date\n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "`ted_dev`.`db_silver`.`stg_sales_order_header`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-19T21:46:52.881219Z", "completed_at": "2025-07-19T21:46:52.892664Z"}, {"name": "execute", "started_at": "2025-07-19T21:46:52.896277Z", "completed_at": "2025-07-19T21:46:52.896289Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.030785322189331055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_checkpoint3_dw.stg_sales_person_details", "compiled": true, "compiled_code": "with source as (\n    select * \n    from `ted_dev`.`bronze`.`raw_sqlserver_sales_vsalesperson_db`\n),\n\nrevised as (\n\n    select\n        BusinessEntityID as sales_person_id,\n        Title as title,\n        FirstName as first_name,\n        MiddleName as middle_name,\n        LastName as last_name,\n        Suffix as suffix,\n        JobTitle as job_title,\n        PhoneNumber as phone_number,\n        PhoneNumberType as phone_number_type,\n        EmailAddress as email_address,\n        EmailPromotion as email_promotion,\n        AddressLine1 as address_line_1,\n        AddressLine2 as address_line_2,\n        City as city,\n        StateProvinceName as state_province_name,\n        PostalCode as postal_code,\n        CountryRegionName as country_region_name,\n        TerritoryName as territory_id,\n        TerritoryGroup as territory_group,\n        cast(SalesQuota as decimal (18,2)) as sales_quota,\n        cast(SalesYTD as decimal (18,2)) as sales_ytd,\n        cast(SalesLastYear as decimal (18,2)) as sales_last_year\n    from source\n)\n\nselect * from revised", "relation_name": "`ted_dev`.`db_silver`.`stg_sales_person_details`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-19T21:46:52.905765Z", "completed_at": "2025-07-19T21:46:52.916796Z"}, {"name": "execute", "started_at": "2025-07-19T21:46:52.922641Z", "completed_at": "2025-07-19T21:46:52.922658Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02581167221069336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_checkpoint3_dw.stg_sales_ship_method", "compiled": true, "compiled_code": "with source as (\n    select * \n    from `ted_dev`.`bronze`.`raw_sqlserver_purchasing_shipmethod_db`\n),\n\nrevised as (\n\n    select\n        cast(ShipMethodID as bigint)         as ship_method_id,\n        cast(Name as  string)                as ship_method_name,\n        cast(ShipBase as decimal (18,2))             as ship_base,\n        cast(ShipRate as decimal (18,2))           as ship_rate,\n        cast(rowguid as string)             as row_guid,\n        cast(ModifiedDate as date)         as modified_date  \n\n    from source\n)\n\nselect * from revised", "relation_name": "`ted_dev`.`db_silver`.`stg_sales_ship_method`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-19T21:46:52.909415Z", "completed_at": "2025-07-19T21:46:52.921305Z"}, {"name": "execute", "started_at": "2025-07-19T21:46:52.924702Z", "completed_at": "2025-07-19T21:46:52.924717Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.026509761810302734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_checkpoint3_dw.stg_sales_territory", "compiled": true, "compiled_code": "with source as (\n    select * \n    from `ted_dev`.`bronze`.`raw_sqlserver_sales_salesterritory_db`\n),\n\nrevised as (\n\n    select\n        cast(TerritoryID as bigint)                 as territory_id,\n        cast(Name as string)                        as territory_name,\n        cast(CountryRegionCode as string)           as country_region_code,\n        cast(Group as string)                       as territory_group,\n        cast(SalesYTD as decimal(18,2))             as sales_ytd,\n        cast(SalesLastYear as decimal(18,2))        as sales_last_year,\n        cast(CostYTD as decimal(18,2))              as cost_ytd,\n        cast(CostLastYear as decimal(18,2))         as cost_last_year,\n        cast(rowguid as string)                     as row_guid,\n        cast(ModifiedDate as date)                  as modified_date\n\n    from source\n)\n\nselect * from revised", "relation_name": "`ted_dev`.`db_silver`.`stg_sales_territory`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-19T21:46:52.913465Z", "completed_at": "2025-07-19T21:46:52.923719Z"}, {"name": "execute", "started_at": "2025-07-19T21:46:52.927621Z", "completed_at": "2025-07-19T21:46:52.927636Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.026357412338256836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_checkpoint3_dw.dim_product", "compiled": true, "compiled_code": "with base as (\n    select \n        product_id,\n        product_name,\n        is_make,\n        is_finished_goods,\n        product_color,\n        standard_cost,\n        list_price,\n        product_line,\n        product_class,\n        product_style,\n        product_subcategory_id,\n        product_model_id\n    from `ted_dev`.`db_silver`.`stg_production_product_details`\n)\n\nselect * from base", "relation_name": "`ted_dev`.`db_gold`.`dim_product`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-19T21:46:52.917685Z", "completed_at": "2025-07-19T21:46:52.925868Z"}, {"name": "execute", "started_at": "2025-07-19T21:46:52.930319Z", "completed_at": "2025-07-19T21:46:52.930332Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.02754068374633789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_checkpoint3_dw.fact_sales_order", "compiled": true, "compiled_code": "with order_detail as (\n    select *\n    from `ted_dev`.`db_silver`.`stg_sales_order_detail`\n),\n\norder_header as (\n    select *\n    from `ted_dev`.`db_silver`.`stg_sales_order_header`\n),\n\njoined as (\n    select\n        -- IDs principais\n        od.order_id,\n        od.order_detail_id,\n\n        -- Produto e oferta\n        od.product_id,\n\n        -- Cliente e vendedor\n        oh.customer_id,\n        oh.sales_person_id,\n        oh.territory_id,\n\n        -- Datas relevantes\n        oh.order_date,\n        oh.due_date,\n        oh.ship_date,\n\n        -- Informa\u00e7\u00f5es de envio e pagamento\n        oh.ship_method_id,\n        oh.currency_rate_id,\n\n        -- Quantidade e pre\u00e7o\n        od.order_quantity,\n        od.unit_price,\n        od.unit_price_discount,\n        od.line_total,\n\n        -- Receita bruta ajustada (sem considerar impostos ou frete)\n        (od.order_quantity * od.unit_price * (1 - od.unit_price_discount)) as gross_revenue,\n\n        -- Flags e rastreabilidade\n        oh.is_online_order,\n        current_timestamp() as ingestion_timestamp\n\n    from order_detail od\n    left join order_header oh\n        on od.order_id = oh.order_id\n)\n\nselect * from joined", "relation_name": "`ted_dev`.`db_gold`.`fact_sales_order`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-19T21:46:52.939835Z", "completed_at": "2025-07-19T21:46:52.951505Z"}, {"name": "execute", "started_at": "2025-07-19T21:46:52.958063Z", "completed_at": "2025-07-19T21:46:52.958078Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.027089595794677734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_checkpoint3_dw.dim_salesperson", "compiled": true, "compiled_code": "with base as (\n    select *\n    from `ted_dev`.`db_silver`.`stg_sales_person_details`\n),\n\nfinal as (\n    select\n        sales_person_id,\n\n        -- Nome completo com seguran\u00e7a contra campos nulos\n        trim(\n            concat_ws(' ',\n                coalesce(first_name, ''),\n                coalesce(middle_name, ''),\n                coalesce(last_name, '')\n            )\n        ) as full_name,\n\n        job_title,\n        email_address,\n\n        -- Limpeza de n\u00famero de telefone (tirando h\u00edfens)\n        regexp_replace(coalesce(phone_number, ''), '-', '') as phone_number,\n\n        -- Garantindo que os valores num\u00e9ricos estejam bem tratados\n        cast(sales_quota as double) as sales_quota,\n        cast(sales_ytd as double) as sales_ytd,\n        cast(sales_last_year as double) as sales_last_year,\n\n        territory_id,\n        territory_group,\n\n        -- Porcentagem da meta batida (com prote\u00e7\u00e3o contra divis\u00e3o por zero ou nulls)\n        case\n            when sales_quota is not null and sales_quota > 0\n                then round((sales_ytd / sales_quota) * 100, 2)\n            else null\n        end as percentual_meta_batida\n\n    from base\n)\n\nselect * from final", "relation_name": "`ted_dev`.`db_gold`.`dim_salesperson`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-19T21:46:52.943636Z", "completed_at": "2025-07-19T21:46:52.957099Z"}, {"name": "execute", "started_at": "2025-07-19T21:46:52.959327Z", "completed_at": "2025-07-19T21:46:52.959341Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02650618553161621, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_checkpoint3_dw.dim_ship_method", "compiled": true, "compiled_code": "with source as (\n    select *\n    from `ted_dev`.`db_silver`.`stg_sales_ship_method`\n),\n\nrenamed as (\n    select\n        ship_method_id,\n        ship_method_name,\n        ship_base,\n        ship_rate,\n        cast(modified_date as date) as modified_date\n    from source\n)\n\nselect * from renamed", "relation_name": "`ted_dev`.`db_gold`.`dim_ship_method`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-19T21:46:52.947402Z", "completed_at": "2025-07-19T21:46:52.960815Z"}, {"name": "execute", "started_at": "2025-07-19T21:46:52.964102Z", "completed_at": "2025-07-19T21:46:52.964115Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02876424789428711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_checkpoint3_dw.dim_costumer", "compiled": true, "compiled_code": "with customer as (\n    select *\n    from `ted_dev`.`db_silver`.`stg_sales_customer_info`\n),\n\nperson as (\n    select *\n    from `ted_dev`.`db_silver`.`stg_person_person_details`\n),\n\nterritory as (\n    select *\n    from `ted_dev`.`db_silver`.`stg_sales_territory`\n),\n\njoined as (\n    select\n        cust.customer_id,\n        cust.person_id,\n        \n        -- Nome completo formatado\n        concat_ws(' ',\n            per.first_name,\n            per.middle_name,\n            per.last_name\n        ) as full_name,\n\n        -- Informa\u00e7\u00f5es do territ\u00f3rio\n        cust.territory_id,\n        terr.territory_name,\n        terr.territory_group,\n        terr.country_region_code\n\n    from customer cust\n    left join person per\n        on cust.person_id = per.person_id\n\n    left join territory terr\n        on cust.territory_id = terr.territory_id\n)\n\nselect * from joined", "relation_name": "`ted_dev`.`db_gold`.`dim_costumer`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-19T21:46:52.952540Z", "completed_at": "2025-07-19T21:46:52.962306Z"}, {"name": "execute", "started_at": "2025-07-19T21:46:52.966439Z", "completed_at": "2025-07-19T21:46:52.966453Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.029877424240112305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_checkpoint3_dw.fact_sales_summary_monthly", "compiled": true, "compiled_code": "with orders as (\n    select\n        ord.order_id,\n        ord.territory_id,\n        terr.territory_name,\n        date_trunc('month', ord.order_date) as year_month,\n        ord.is_online_order,\n        ord.total_due,\n        ord.freight,\n        ord.tax_amount\n    from `ted_dev`.`db_silver`.`stg_sales_order_header` ord\n    left join `ted_dev`.`db_silver`.`stg_sales_territory` terr\n        on ord.territory_id = terr.territory_id\n),\n\norder_items as (\n    select\n        order_id,\n        sum(order_quantity) as total_items\n    from `ted_dev`.`db_silver`.`stg_sales_order_detail`\n    group by order_id\n),\n\njoined as (\n    select\n        o.year_month,\n        o.territory_id,\n        o.territory_name,\n        o.is_online_order,\n        o.total_due,\n        o.freight,\n        o.tax_amount,\n        i.total_items\n    from orders o\n    left join order_items i\n        on o.order_id = i.order_id\n),\n\naggregated as (\n    select\n        year_month,\n        territory_id,\n        territory_name,\n        is_online_order,\n        count(*) as total_orders,\n        sum(total_items) as total_items_sold,\n        sum(total_due) as revenue,\n        sum(freight) as freight_total,\n        sum(tax_amount) as tax_total,\n        round(sum(total_due) / nullif(count(*), 0), 2) as average_order_value\n    from joined\n    group by\n        year_month,\n        territory_id,\n        territory_name,\n        is_online_order\n)\n\nselect * from aggregated", "relation_name": "`ted_dev`.`db_gold`.`fact_sales_summary_monthly`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-19T21:46:52.975897Z", "completed_at": "2025-07-19T21:46:53.006562Z"}, {"name": "execute", "started_at": "2025-07-19T21:46:53.013149Z", "completed_at": "2025-07-19T21:46:53.013162Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.047840118408203125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_checkpoint3_dw.unique_dim_product_product_id.46495bf7fe", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    product_id as unique_field,\n    count(*) as n_records\n\nfrom `ted_dev`.`db_gold`.`dim_product`\nwhere product_id is not null\ngroup by product_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-19T21:46:52.990056Z", "completed_at": "2025-07-19T21:46:53.012216Z"}, {"name": "execute", "started_at": "2025-07-19T21:46:53.015505Z", "completed_at": "2025-07-19T21:46:53.015520Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.048302650451660156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_checkpoint3_dw.not_null_fact_sales_order_order_id.50586c4105", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_id\nfrom `ted_dev`.`db_gold`.`fact_sales_order`\nwhere order_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-19T21:46:53.001928Z", "completed_at": "2025-07-19T21:46:53.014388Z"}, {"name": "execute", "started_at": "2025-07-19T21:46:53.018283Z", "completed_at": "2025-07-19T21:46:53.018299Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.046320438385009766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_checkpoint3_dw.unique_dim_salesperson_email_address.d5c9dadc77", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    email_address as unique_field,\n    count(*) as n_records\n\nfrom `ted_dev`.`db_gold`.`dim_salesperson`\nwhere email_address is not null\ngroup by email_address\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-19T21:46:53.007304Z", "completed_at": "2025-07-19T21:46:53.017674Z"}, {"name": "execute", "started_at": "2025-07-19T21:46:53.020845Z", "completed_at": "2025-07-19T21:46:53.020857Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.04723548889160156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_checkpoint3_dw.unique_dim_ship_method_ship_method_id.740db4805a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    ship_method_id as unique_field,\n    count(*) as n_records\n\nfrom `ted_dev`.`db_gold`.`dim_ship_method`\nwhere ship_method_id is not null\ngroup by ship_method_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-19T21:46:53.028001Z", "completed_at": "2025-07-19T21:46:53.043062Z"}, {"name": "execute", "started_at": "2025-07-19T21:46:53.044007Z", "completed_at": "2025-07-19T21:46:53.044021Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02411937713623047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_checkpoint3_dw.unique_dim_costumer_customer_id.ac6c58650b", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom `ted_dev`.`db_gold`.`dim_costumer`\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-19T21:46:53.032933Z", "completed_at": "2025-07-19T21:46:53.045355Z"}, {"name": "execute", "started_at": "2025-07-19T21:46:53.046552Z", "completed_at": "2025-07-19T21:46:53.046566Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.024184465408325195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_checkpoint3_dw.not_null_fact_sales_summary_monthly_year_month.7f35d1d1fa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect year_month\nfrom `ted_dev`.`db_gold`.`fact_sales_summary_monthly`\nwhere year_month is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-19T21:46:53.037833Z", "completed_at": "2025-07-19T21:46:53.046033Z"}, {"name": "execute", "started_at": "2025-07-19T21:46:53.047383Z", "completed_at": "2025-07-19T21:46:53.047395Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.022950172424316406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_checkpoint3_dw.unique_fact_sales_summary_monthly__year_month_territory_id_is_online_order_.b72abecf73", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    (year_month, territory_id, is_online_order) as unique_field,\n    count(*) as n_records\n\nfrom `ted_dev`.`db_gold`.`fact_sales_summary_monthly`\nwhere (year_month, territory_id, is_online_order) is not null\ngroup by (year_month, territory_id, is_online_order)\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}], "elapsed_time": 3.101654052734375, "args": {"macro_debugging": false, "require_explicit_package_overrides_for_builtin_materializations": true, "source_freshness_run_project_hooks": true, "static": false, "quiet": false, "printer_width": 80, "warn_error_options": {"error": [], "warn": [], "silence": []}, "show_all_deprecations": false, "introspect": true, "indirect_selection": "eager", "log_level_file": "debug", "require_all_warnings_handled_by_warn_error": false, "log_format_file": "debug", "use_colors": true, "version_check": true, "empty_catalog": false, "partial_parse": true, "state_modified_compare_more_unrendered_values": false, "populate_cache": true, "require_batched_execution_for_custom_microbatch_strategy": false, "favor_state": false, "compile": true, "log_path": "/home/alexandrersf/projects/checkpoint2_meltano/checkpoint2_meltano_code/logs", "require_resource_names_without_spaces": true, "require_nested_cumulative_type_params": false, "require_yaml_configuration_for_mf_time_spines": false, "use_fast_test_edges": false, "project_dir": "/home/alexandrersf/projects/checkpoint2_meltano/checkpoint2_meltano_code", "profiles_dir": "/home/alexandrersf/projects/checkpoint2_meltano/checkpoint2_meltano_code", "vars": {}, "write_json": true, "defer": false, "partial_parse_file_diff": true, "log_format": "default", "select": [], "validate_macro_args": false, "strict_mode": false, "cache_selected_only": false, "print": true, "invocation_command": "dbt docs generate", "show_resource_report": false, "state_modified_compare_vars": false, "log_level": "info", "static_parser": true, "upload_to_artifacts_ingest_api": false, "send_anonymous_usage_stats": true, "which": "generate", "skip_nodes_if_on_run_start_fails": false, "use_colors_file": true, "log_file_max_bytes": 10485760, "exclude": []}}